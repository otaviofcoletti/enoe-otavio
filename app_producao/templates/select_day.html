<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seleção de Data - Projeto E-noé</title>
    <meta name="description" content="Selecione uma data para visualizar as fotos capturadas pelo sistema de monitoramento.">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/variables.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/header.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/footer.css') }}">
</head>
<body>
    <header class="header">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <h1><i class="fas fa-water"></i> E-noé</h1>
                </div>
                <ul class="nav-menu">
                    <li><a href="/" class="nav-link">Início</a></li>
                    <li><a href="/last_photo" class="nav-link">Última Foto</a></li>
                    <li><a href="/select_day" class="nav-link active">Seleção de Data</a></li>
                    <li><a href="/publications" class="nav-link">Publicações</a></li>
                </ul>
                <div class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <div class="page-header-content">
                <h1 class="page-title">
                    <i class="fas fa-calendar-alt"></i>
                    Seleção de Data
                </h1>
                <p class="page-description">
                    Escolha uma data para visualizar as fotos capturadas pelo sistema de monitoramento
                </p>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <div class="date-selector">
                <!-- Calendar Container -->
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="nav-btn" id="prevMonth">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h2 class="calendar-title" id="currentMonth"></h2>
                        <button class="nav-btn" id="nextMonth">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    
                    <div class="calendar-grid">
                        <div class="calendar-days-header">
                            <div class="day-header">Dom</div>
                            <div class="day-header">Seg</div>
                            <div class="day-header">Ter</div>
                            <div class="day-header">Qua</div>
                            <div class="day-header">Qui</div>
                            <div class="day-header">Sex</div>
                            <div class="day-header">Sáb</div>
                        </div>
                        <div class="calendar-days" id="calendarDays">
                            <!-- Days will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Selected Date Info -->
                <div class="selected-date-info" id="selectedDateInfo" style="display: none;">
                    <div class="date-info-header">
                        <h3><i class="fas fa-camera"></i> Fotos Disponíveis</h3>
                        <span class="photo-count" id="photoCount">0 fotos</span>
                    </div>
                    <div class="date-actions">
                        <button class="btn btn-primary" id="viewPhotosBtn">
                            <i class="fas fa-images"></i>
                            Ver Galeria
                        </button>
                        <button class="btn btn-secondary" id="downloadAllBtn">
                            <i class="fas fa-download"></i>
                            Baixar Todas
                        </button>
                    </div>
                </div>

                <!-- Statistics Card -->
                <div class="stats-card">
                    <h3><i class="fas fa-chart-bar"></i> Estatísticas do Sistema</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-number" id="totalDays">{{ dates|length }}</span>
                                <span class="stat-label">Dias com Dados</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-images"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-number">24/7</span>
                                <span class="stat-label">Capturas Contínuas</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content">
                                <span class="stat-number">Real-time</span>
                                <span class="stat-label">Monitoramento</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Access -->
                <div class="quick-access">
                    <h3><i class="fas fa-bolt"></i> Acesso Rápido</h3>
                    <div class="quick-buttons">
                        <a href="/last_photo" class="quick-btn">
                            <i class="fas fa-camera"></i>
                            <span>Última Foto</span>
                        </a>
                        <button class="quick-btn" onclick="selectToday()">
                            <i class="fas fa-calendar-day"></i>
                            <span>Hoje</span>
                        </button>
                        <button class="quick-btn" onclick="selectYesterday()">
                            <i class="fas fa-history"></i>
                            <span>Ontem</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <h3><i class="fas fa-water"></i> Projeto E-noé</h3>
                        <p>Monitoramento inteligente para rios urbanos mais seguros.</p>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Navegação</h4>
                    <ul>
                        <li><a href="/">Início</a></li>
                        <li><a href="/last_photo">Última Foto</a></li>
                        <li><a href="/select_day">Seleção de Data</a></li>
                        <li><a href="/publications">Publicações</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Dados Históricos</h4>
                    <p>Acesse fotos históricas do sistema de monitoramento para análise temporal.</p>
                </div>
                <div class="footer-section">
                    <h4>Calendário</h4>
                    <p>Interface intuitiva para navegar pelos dados capturados.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Projeto E-noé. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Hidden form for submission -->
    <form method="post" id="dateForm" style="display: none;">
        <input type="hidden" name="date" id="selectedDateInput">
    </form>

    <!-- Scripts -->
    <script>
        // Available dates from server
        const availableDates = {{ dates | tojson }};
        
        // Calendar functionality
        class CalendarApp {
            constructor() {
                this.currentDate = new Date();
                this.selectedDate = null;
                this.monthNames = [
                    'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                    'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
                ];
                this.init();
            }
            
            init() {
                this.bindEvents();
                this.renderCalendar();
            }
            
            bindEvents() {
                document.getElementById('prevMonth').addEventListener('click', () => this.previousMonth());
                document.getElementById('nextMonth').addEventListener('click', () => this.nextMonth());
                document.getElementById('viewPhotosBtn').addEventListener('click', () => this.viewPhotos());
                document.getElementById('downloadAllBtn').addEventListener('click', () => this.downloadAll());
            }
            
            previousMonth() {
                this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                this.renderCalendar();
            }
            
            nextMonth() {
                this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                this.renderCalendar();
            }
            
            renderCalendar() {
                const monthYear = `${this.monthNames[this.currentDate.getMonth()]} ${this.currentDate.getFullYear()}`;
                document.getElementById('currentMonth').textContent = monthYear;
                
                const firstDay = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1);
                const lastDay = new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay());
                
                const calendarDays = document.getElementById('calendarDays');
                calendarDays.innerHTML = '';
                
                for (let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);
                    
                    const dayElement = document.createElement('div');
                    dayElement.className = 'calendar-day';
                    
                    const isCurrentMonth = date.getMonth() === this.currentDate.getMonth();
                    const isToday = this.isToday(date);
                    const hasData = this.hasDataForDate(date);
                    
                    if (!isCurrentMonth) {
                        dayElement.classList.add('other-month');
                    }
                    if (isToday) {
                        dayElement.classList.add('today');
                    }
                    if (hasData) {
                        dayElement.classList.add('has-data');
                        dayElement.addEventListener('click', () => this.selectDate(date));
                    }
                    if (this.selectedDate && this.isSameDate(date, this.selectedDate)) {
                        dayElement.classList.add('selected');
                    }
                    
                    dayElement.innerHTML = `
                        <span class="day-number">${date.getDate()}</span>
                        ${hasData ? '<div class="data-indicator"></div>' : ''}
                    `;
                    
                    calendarDays.appendChild(dayElement);
                }
            }
            
            hasDataForDate(date) {
                const dateString = date.toISOString().split('T')[0];
                return availableDates.includes(dateString);
            }
            
            isToday(date) {
                const today = new Date();
                return this.isSameDate(date, today);
            }
            
            isSameDate(date1, date2) {
                return date1.toDateString() === date2.toDateString();
            }
            
            selectDate(date) {
                this.selectedDate = date;
                this.renderCalendar();
                this.showDateInfo(date);
            }
            
            showDateInfo(date) {
                const dateString = date.toISOString().split('T')[0];
                const photoCount = Math.floor(Math.random() * 50) + 10; // Simulated count
                
                document.getElementById('selectedDateInfo').style.display = 'block';
                document.getElementById('photoCount').textContent = `${photoCount} fotos`;
                document.getElementById('selectedDateInput').value = dateString;
                
                // Scroll to info
                document.getElementById('selectedDateInfo').scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'nearest' 
                });
            }
            
            viewPhotos() {
                if (this.selectedDate) {
                    document.getElementById('dateForm').submit();
                }
            }
            
            downloadAll() {
                if (this.selectedDate) {
                    // Implement download functionality
                    alert('Função de download será implementada em breve!');
                }
            }
        }
        
        // Quick access functions
        function selectToday() {
            const today = new Date();
            const dateString = today.toISOString().split('T')[0];
            if (availableDates.includes(dateString)) {
                calendar.selectDate(today);
            } else {
                alert('Não há dados disponíveis para hoje.');
            }
        }
        
        function selectYesterday() {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const dateString = yesterday.toISOString().split('T')[0];
            if (availableDates.includes(dateString)) {
                calendar.selectDate(yesterday);
            } else {
                alert('Não há dados disponíveis para ontem.');
            }
        }
        
        // Mobile menu toggle
        const hamburger = document.querySelector('.hamburger');
        const navMenu = document.querySelector('.nav-menu');
        
        if (hamburger && navMenu) {
            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                navMenu.classList.toggle('active');
            });
            
            document.querySelectorAll('.nav-link').forEach(n => n.addEventListener('click', () => {
                hamburger.classList.remove('active');
                navMenu.classList.remove('active');
            }));
        }
        
        // Initialize calendar when DOM is loaded
        let calendar;
        document.addEventListener('DOMContentLoaded', () => {
            calendar = new CalendarApp();
        });
    </script>

    <!-- Calendar CSS -->
    <style>
        /* Calendar Styles */
        .date-selector {
            max-width: 1000px;
            margin: 0 auto;
            padding: var(--space-8) 0;
            display: grid;
            gap: var(--space-8);
        }
        
        .calendar-container {
            background: white;
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            border: 1px solid var(--gray-200);
        }
        
        .calendar-header {
            background: var(--gradient-primary);
            color: white;
            padding: var(--space-6);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .calendar-title {
            font-size: var(--text-2xl);
            font-weight: var(--font-semibold);
            margin: 0;
        }
        
        .nav-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-base);
        }
        
        .nav-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }
        
        .calendar-grid {
            padding: var(--space-6);
        }
        
        .calendar-days-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--space-2);
            margin-bottom: var(--space-4);
        }
        
        .day-header {
            text-align: center;
            font-weight: var(--font-semibold);
            color: var(--gray-600);
            padding: var(--space-2);
            font-size: var(--text-sm);
        }
        
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--space-2);
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition-base);
            position: relative;
            min-height: 50px;
        }
        
        .calendar-day.other-month {
            color: var(--gray-400);
            cursor: default;
        }
        
        .calendar-day.today {
            background: var(--primary-100);
            color: var(--primary-700);
            font-weight: var(--font-semibold);
        }
        
        .calendar-day.has-data {
            background: var(--gray-100);
            border: 2px solid var(--primary-300);
        }
        
        .calendar-day.has-data:hover {
            background: var(--primary-100);
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }
        
        .calendar-day.selected {
            background: var(--primary-600);
            color: white;
        }
        
        .day-number {
            font-size: var(--text-base);
            font-weight: var(--font-medium);
        }
        
        .data-indicator {
            width: 6px;
            height: 6px;
            background: var(--secondary-500);
            border-radius: var(--radius-full);
            margin-top: 2px;
        }
        
        .selected-date-info {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
        }
        
        .date-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }
        
        .date-info-header h3 {
            margin: 0;
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .photo-count {
            background: var(--primary-100);
            color: var(--primary-700);
            padding: var(--space-1) var(--space-3);
            border-radius: var(--radius-full);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
        }
        
        .date-actions {
            display: flex;
            gap: var(--space-3);
        }
        
        .stats-card {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
        }
        
        .stats-card h3 {
            margin: 0 0 var(--space-4);
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-4);
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-4);
            background: var(--gray-50);
            border-radius: var(--radius-lg);
        }
        
        .stat-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .stat-content {
            display: flex;
            flex-direction: column;
        }
        
        .stat-number {
            font-size: var(--text-lg);
            font-weight: var(--font-bold);
            color: var(--gray-900);
        }
        
        .stat-label {
            font-size: var(--text-sm);
            color: var(--gray-600);
        }
        
        .quick-access {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
        }
        
        .quick-access h3 {
            margin: 0 0 var(--space-4);
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .quick-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-3);
        }
        
        .quick-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-4);
            background: var(--gray-50);
            border: 2px solid transparent;
            border-radius: var(--radius-lg);
            text-decoration: none;
            color: var(--gray-700);
            transition: var(--transition-base);
            cursor: pointer;
        }
        
        .quick-btn:hover {
            background: var(--primary-50);
            border-color: var(--primary-200);
            color: var(--primary-700);
            transform: translateY(-2px);
        }
        
        .quick-btn i {
            font-size: var(--text-xl);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .calendar-header {
                padding: var(--space-4);
            }
            
            .calendar-title {
                font-size: var(--text-lg);
            }
            
            .calendar-grid {
                padding: var(--space-4);
            }
            
            .day-header {
                font-size: var(--text-xs);
                padding: var(--space-1);
            }
            
            .calendar-day {
                min-height: 40px;
            }
            
            .day-number {
                font-size: var(--text-sm);
            }
            
            .date-actions {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</body>
</html>
